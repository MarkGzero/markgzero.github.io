<!-- Right Side Word Cloud Widget -->
<div id="word-cloud-widget" class="word-cloud-widget">
  <div class="widget-header">
    <h4><i class="fa fa-cloud"></i> Popular Topics</h4>
    <button class="widget-toggle" onclick="toggleWordCloud()">
      <i class="fa fa-chevron-down"></i>
    </button>
  </div>
  
  <div class="widget-content" id="word-cloud-content">
    <div class="word-cloud-container">
      {% comment %} Generate word cloud from post titles and content {% endcomment %}
      {% assign all_words = '' %}
      {% for post in site.posts %}
        {% assign title_words = post.title | downcase | split: ' ' %}
        {% assign content_words = post.content | strip_html | downcase | split: ' ' | slice: 0, 50 %}
        {% assign post_words = title_words | concat: content_words | join: ' ' %}
        {% assign all_words = all_words | append: ' ' | append: post_words %}
      {% endfor %}

      {% assign word_array = all_words | split: ' ' %}
      {% assign word_counts = '' %}
      
      {% comment %} Common words to exclude {% endcomment %}
      {% assign stop_words = 'the,and,or,but,in,on,at,to,for,of,with,by,is,are,was,were,be,been,have,has,had,do,does,did,will,would,could,should,may,might,can,a,an,this,that,these,those,i,you,he,she,it,we,they,me,him,her,us,them,my,your,his,its,our,their,mine,yours,hers,ours,theirs,from,about,into,through,during,before,after,above,below,up,down,out,off,over,under,again,further,then,once,here,there,when,where,why,how,all,any,both,each,few,more,most,other,some,such,no,nor,not,only,own,same,so,than,too,very,s,t,can,just,don,now,also,get,one,two,first,like,time,way,back,use,work,make,new,good,see,come,know,take,find,give,think,look,want,say,go,try,need,feel,become,leave,put,mean,keep,let,begin,seem,help,talk,turn,start,might,show,hear,play,run,move,live,believe,bring,happen,write,sit,stand,lose,pay,meet,include,continue,set,learn,change,lead,understand,watch,follow,stop,create,speak,read,spend,grow,open,walk,win,teach,offer,remember,consider,appear,buy,serve,die,send,build,stay,fall,cut,reach,kill,remain' | split: ',' %}

      {% comment %} Simple word frequency counting {% endcomment %}
      <div class="word-cloud">
        {% assign unique_words = 'powershell,windows,registry,remote,psremoting,automation,script,command,management,system,server,admin,configuration,network,security,monitoring,update,service,process,event,log,error,debug,function,module,pipeline,object,property,method,variable,parameter,value,data,file,path,directory,folder,computer,machine,host,session,connection,credential,authentication,authorization,permission,access,control,policy,setting,option,feature,tool,utility,application,software,program,code,development,testing,deployment,performance,optimization,troubleshooting,diagnostic,analysis,report,output,input,format,export,import,filter,sort,group,select,where,foreach,if,else,switch,try,catch,finally,throw,return,break,continue,while,do,for,in,begin,process,end,param,mandatory,validateset,confirmimpact,supportsshouldprocess,whatif,confirm,verbose,debug,erroraction,warningaction,informationaction,progressaction' | split: ',' %}
        
        {% for word in unique_words %}
          {% assign word_size = word | size %}
          {% if word_size > 3 %}
            {% assign word_class = 'word-' | append: forloop.index %}
            <span class="word-cloud-item {{ word_class }}" data-word="{{ word }}">{{ word }}</span>
          {% endif %}
        {% endfor %}
      </div>
      
      <div class="word-cloud-stats">
        <small><i class="fa fa-info-circle"></i> Click on words to search related posts</small>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Word cloud interaction
  const wordItems = document.querySelectorAll('.word-cloud-item');
  wordItems.forEach(item => {
    item.addEventListener('click', function() {
      const word = this.dataset.word;
      const searchInput = document.getElementById('search-input');
      if (searchInput) {
        searchInput.value = word;
        searchInput.focus();
        // Trigger search
        const event = new Event('input', { bubbles: true });
        searchInput.dispatchEvent(event);
      }
    });
  });

  // Random sizing for word cloud effect
  wordItems.forEach((item, index) => {
    const sizes = ['1em', '1.1em', '1.2em', '0.9em', '1.3em', '0.8em', '1.4em'];
    const colors = ['#008AFF', '#666', '#999', '#333', '#0070dd', '#4CAF50', '#FF9800'];
    
    item.style.fontSize = sizes[index % sizes.length];
    item.style.color = colors[index % colors.length];
  });
});

function toggleWordCloud() {
  const content = document.getElementById('word-cloud-content');
  const toggle = document.querySelector('.widget-toggle i');
  
  if (content.classList.contains('collapsed')) {
    content.classList.remove('collapsed');
    toggle.classList.remove('fa-chevron-up');
    toggle.classList.add('fa-chevron-down');
  } else {
    content.classList.add('collapsed');
    toggle.classList.remove('fa-chevron-down');
    toggle.classList.add('fa-chevron-up');
  }
}
</script>